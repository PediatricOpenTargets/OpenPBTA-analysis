## Match and map genes to PMTL approved symbols

# Description
This modules merges extracts and merges the genes and gene symbols from various Gencode versions and maps them to the approved gene symbols in the current PMTL version.

This module allows scientists/users to track Ensembl gene ids, including the approved PMTL genes to their latest gene symbols as found in Gencode files. Currently, Pediatric Open Targets uses the Gencode v39 version, and the gene symbols found are labelled as `latest_gene_symbol` in the `results/ensg-hugo-pmtl-mapping.tsv` file.


## Module scripts and files

# Run module scripts as below
```
bash run-gene-mapping.sh
```

# Input files
GTF file sources:

- gencode v27 <http://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_27>/gencode.v27.annotation.gtf.gz
`input\gencode.v27.annotation.gtf.gz`
- gencode v28 <http://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_28>/gencode.v28.annotation.gtf.gz
`input\gencode.v28.annotation.gtf.gz`
- gencode v36 <http://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_36>/gencode.v36.annotation.gtf.gz
`input\gencode.v36.annotation.gtf.gz`
- gencode v38 <http://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_38>/gencode.v38.annotation.gtf.gz
`input\gencode.v38.annotation.gtf.gz`
- gencode v39 <http://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_39>/gencode.v39.annotation.gtf.gz
`input\gencode.v39.annotation.gtf.gz`
- Base file for mapping OpenPecCan genes 
`input\open_ped_can_v7_ensg-hugo-rmtl-mapping.tsv`
source: <https://s3.amazonaws.com/kf-openaccess-us-east-1-prd-pbta/open-targets/v7/ensg-hugo-rmtl-mapping.tsv>

- Most recent version of approved list of OpenPedCan genes 
`input\PMTL_v1.1.tsv`


# Module scripts

Match ensembl to gene_symbol using Gencode gtf files and OpenPedCan 
`gene_match/01-gene-ensembl-id-from-gtf.R`: Read GTF file and formats `attributes` to extract gene symbol with gene ensembl ID.


`gene_match/02-merge-gencode-ensg-symbol-map.R`: Merges v27,v28, v36, v38, and v39 gencode versions and `input\open_ped_can_v7_ensg-hugo-rmtl-mapping.tsv`.

`gene_match/03-add-pmtl-ensg-hugo.Rmd`: Merges PMTL v 1.1 with 
`ensembl_gene_symbol_gtf_genode_all_open_ped_can_v7_merged.tsv` generated by above script execution.

`gene_match\04-qc-ensg-hugo-pmtl-mapping.Rmd` : QC to see if all gene symbols found in the CNV, SNV, TPM, and Fusion data files in the current data release are found in the mapping file `results/ensg-hugo-pmtl-mapping.tsv` generated by above script execution. If not, extract the ENSG IDs for genes whose symbols are missing.

## Package version

org.Hs.eg.db 3.7.0
GenomicFeatures 1.34.3
AnnotationDbi 1.44.0

## Note :
Since some of the scripts require high CPU processing capacity, this module must be run on EC2.
