## OpenPBTA Oncoprint Landscape

**Module authors:** Chante Bethell ([@cbethell](https://github.com/cbethell)), Jaclyn Taroni ([@jaclyn-taroni](https://github.com/jaclyn-taroni)), and Yuanchao Zhang ([@logstar](https://github.com/logstar))

The purposes of this module:

- Plot the landscape of the consensus CNV, SNV and fusion [PediatricOpenTargets/OpenPedCan-analysis](https://github.com/PediatricOpenTargets/OpenPedCan-analysis) datasets.
- Generate mutation frequency tables of the consensus CNV, SNV and fusion [PediatricOpenTargets/OpenPedCan-analysis](https://github.com/PediatricOpenTargets/OpenPedCan-analysis) datasets.

### Usage

To run the Rscripts in this module from the command line as intended, use:

```bash
bash run-oncoprint.sh
```

`run-oncoprint.sh` is designed to be run as if it was called from this module directory even when called from outside of this directory.

### Folder content

- `00-map-to-sample_id.R` prepares MAF, focal CN (from the "most focal" output of the `focal-cn-file-preparation` module), and standardized fusion files for use with `01-plot-oncoprint.R`.
  - The `Tumor_Sample_Barcode` column in the output corresponds to the `Kids_First_Biospecimen_ID` column in the histologies file
  - Subset independent samples using an [independent specimen file](https://github.com/PediatricOpenTargets/OpenPedCan-analysis/tree/dev/analyses/independent-samples) is optional.
- `01-plot-oncoprint.R` plots `maftools::oncoplot` and generates mutation frequency table for each `cancer_group`/`cancer_group_cohort`.
  - Input:
    - The files generated by `00-map-to-sample_id.R`.
    - Optionally a file or set of files (to be concatenated) that will restrict the set of genes that are being plotted in an OncoPrint. Call this `goi_list` (gene of interest list).
  - Output:
    - One `maftools::oncoplot` of top 20 mutated genes for each `cancer_group`/`cancer_group_cohort` with >= 5 samples.
    - One mutation frequency table for each `cancer_group`/`cancer_group_cohort` with >= 5 samples.
    - If `goi_list` is provided, one `maftools::oncoplot` of the genes in the `goi_list` for each `cancer_group`/`cancer_group_cohort` with >= 5 samples. For example, running this via `run-oncoprint.sh` will restrict plotting to a list of top mutated genes (generated in `analyses/interaction-plots/scripts/01-disease-specimen-lists.R`) and top genes with recurrent CNVs (generated in `analyses/focal-cn-file-preparation/06-find-recurrent-calls.Rmd`).

### Folder Structure

```text
```

Gene lists in `driver-lists` were obtained from <https://github.com/marislab/create-pptc-pdx-oncoprints/tree/2c9ed2a2331bcef3003d6aa25a130485d76a3535/data>.
